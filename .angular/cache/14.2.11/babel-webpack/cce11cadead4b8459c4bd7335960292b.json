{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/perfil.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\n\nfunction ModuleCrudComponent_li_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementStart(2, \"div\", 16)(3, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function ModuleCrudComponent_li_25_Template_button_click_3_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const module_r2 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.editModule(module_r2));\n    });\n    i0.ɵɵtext(4, \"Editar\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function ModuleCrudComponent_li_25_Template_button_click_5_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const module_r2 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.confirmDeleteModule(module_r2));\n    });\n    i0.ɵɵtext(6, \"Eliminar\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const module_r2 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", module_r2.nombre, \" \");\n  }\n}\n\nfunction ModuleCrudComponent_div_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 18)(1, \"div\", 19)(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 10)(5, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function ModuleCrudComponent_div_26_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.cancelDelete());\n    });\n    i0.ɵɵtext(6, \"Cancelar\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function ModuleCrudComponent_div_26_Template_button_click_7_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.deleteModule(ctx_r8.moduleToDelete._id));\n    });\n    i0.ɵɵtext(8, \"Eliminar\");\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\\u00BFEst\\u00E1s seguro de que deseas eliminar el m\\u00F3dulo \\\"\", ctx_r1.moduleToDelete.nombre, \"\\\"?\");\n  }\n}\n\nexport let ModuleCrudComponent = /*#__PURE__*/(() => {\n  class ModuleCrudComponent {\n    constructor(perfilService, router) {\n      this.perfilService = perfilService;\n      this.router = router;\n      this.moduleData = {\n        nombre: '',\n        descripcion: '',\n        imagen: ''\n      };\n      this.modules = [];\n      this.isEditMode = false;\n      this.selectedModuleId = null;\n      this.moduleToDelete = null;\n      this.searchTerm = '';\n      this.filteredModules = [];\n    }\n\n    ngOnInit() {\n      // Obtén la lista completa de módulos\n      this.perfilService.getModules().subscribe({\n        next: modules => {\n          this.modules = modules;\n          this.filteredModules = modules; // Mostrar la lista completa inicialmente\n        },\n        error: error => {\n          console.log('Error al obtener la lista de módulos:', error);\n        }\n      });\n    }\n\n    loadModules() {\n      this.perfilService.getModules().subscribe({\n        next: modules => {\n          this.modules = modules;\n          this.filteredModules = modules; // Mostrar la lista completa inicialmente\n        },\n        error: error => {\n          console.log('Error al obtener la lista de módulos:', error);\n        }\n      });\n    }\n\n    createModule() {\n      this.perfilService.createModule(this.moduleData).subscribe({\n        next: createdModule => {\n          this.modules.push(createdModule);\n          this.resetForm();\n        },\n        error: error => {\n          console.log('Error al crear el módulo:', error);\n        }\n      });\n    }\n\n    updateModule() {\n      if (this.selectedModuleId) {\n        this.perfilService.updateModule(this.selectedModuleId, this.moduleData).subscribe({\n          next: updatedModule => {\n            const index = this.modules.findIndex(module => module._id === this.selectedModuleId);\n\n            if (index !== -1) {\n              this.modules[index] = updatedModule;\n              this.resetForm();\n            }\n          },\n          error: error => {\n            console.log('Error al actualizar el módulo:', error);\n          }\n        });\n      }\n    }\n\n    editModule(module) {\n      this.selectedModuleId = module._id;\n      this.moduleData = { ...module\n      };\n      this.isEditMode = true;\n    }\n\n    deleteModule(moduleId) {\n      this.perfilService.deleteModule(moduleId).subscribe({\n        next: () => {\n          // Elimina el módulo de la lista local\n          this.modules = this.modules.filter(module => module._id !== moduleId);\n          this.resetForm(); // Cierra el mensaje modal\n\n          this.cancelDelete(); // Actualiza la lista completa de módulos desde el servidor\n\n          this.loadModules();\n        },\n        error: error => {\n          console.log('Error al eliminar el módulo:', error);\n        }\n      });\n    }\n\n    resetForm() {\n      this.moduleData = {\n        nombre: '',\n        descripcion: '',\n        imagen: ''\n      };\n      this.isEditMode = false;\n      this.selectedModuleId = null;\n    }\n\n    areFieldsValid() {\n      const nombreValid = !!this.moduleData.nombre;\n      const descripcionValid = !!this.moduleData.descripcion;\n      const imagenValid = !!this.moduleData.imagen; // Aplicar clases de error si los campos están vacíos\n\n      if (!nombreValid) {\n        this.addErrorClassToField('nombre');\n      } else {\n        this.removeErrorClassFromField('nombre');\n      }\n\n      if (!descripcionValid) {\n        this.addErrorClassToField('descripcion');\n      } else {\n        this.removeErrorClassFromField('descripcion');\n      }\n\n      if (!imagenValid) {\n        this.addErrorClassToField('imagen');\n      } else {\n        this.removeErrorClassFromField('imagen');\n      }\n\n      return nombreValid && descripcionValid && imagenValid;\n    } // Función para agregar una clase de error a un campo\n\n\n    addErrorClassToField(fieldName) {\n      const fieldElement = document.getElementById(fieldName);\n\n      if (fieldElement) {\n        fieldElement.classList.add('error');\n      }\n    } // Función para quitar una clase de error de un campo\n\n\n    removeErrorClassFromField(fieldName) {\n      const fieldElement = document.getElementById(fieldName);\n\n      if (fieldElement) {\n        fieldElement.classList.remove('error');\n      }\n    }\n\n    confirmDeleteModule(module) {\n      this.moduleToDelete = module; // Aquí puedes mostrar un mensaje modal o una ventana emergente para confirmar la eliminación.\n    }\n\n    cancelDelete() {\n      this.moduleToDelete = null;\n    }\n\n    filterModules() {\n      if (this.searchTerm.trim() === '') {\n        // Si el término de búsqueda está vacío, muestra todos los módulos\n        this.filteredModules = this.modules;\n      } else {\n        // Filtra los módulos en función del término de búsqueda\n        this.filteredModules = this.modules.filter(module => module.nombre.toLowerCase().includes(this.searchTerm.toLowerCase()));\n      }\n    }\n\n  }\n\n  ModuleCrudComponent.ɵfac = function ModuleCrudComponent_Factory(t) {\n    return new (t || ModuleCrudComponent)(i0.ɵɵdirectiveInject(i1.PerfilService), i0.ɵɵdirectiveInject(i2.Router));\n  };\n\n  ModuleCrudComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ModuleCrudComponent,\n    selectors: [[\"app-module-crud\"]],\n    decls: 27,\n    vars: 9,\n    consts: [[1, \"module-crud-container\"], [1, \"module-form\"], [3, \"ngSubmit\"], [1, \"form-group\"], [\"for\", \"nombre\"], [\"type\", \"text\", \"id\", \"nombre\", \"name\", \"nombre\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"descripcion\"], [\"id\", \"descripcion\", \"name\", \"descripcion\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"imagen\"], [\"type\", \"text\", \"id\", \"imagen\", \"name\", \"imagen\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [2, \"text-align\", \"right\"], [\"type\", \"submit\", 1, \"boton\", 3, \"disabled\"], [1, \"module-list\"], [\"type\", \"text\", \"placeholder\", \"Buscar m\\u00F3dulos\", 3, \"ngModel\", \"ngModelChange\", \"input\"], [4, \"ngFor\", \"ngForOf\"], [\"class\", \"modal\", 4, \"ngIf\"], [1, \"buttons-container\", 2, \"text-align\", \"right\"], [3, \"click\"], [1, \"modal\"], [1, \"modal-content\"], [1, \"boton\", 3, \"click\"]],\n    template: function ModuleCrudComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\");\n        i0.ɵɵtext(3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"form\", 2);\n        i0.ɵɵlistener(\"ngSubmit\", function ModuleCrudComponent_Template_form_ngSubmit_4_listener() {\n          return ctx.isEditMode ? ctx.updateModule() : ctx.createModule();\n        });\n        i0.ɵɵelementStart(5, \"div\", 3)(6, \"label\", 4);\n        i0.ɵɵtext(7, \"Nombre:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"input\", 5);\n        i0.ɵɵlistener(\"ngModelChange\", function ModuleCrudComponent_Template_input_ngModelChange_8_listener($event) {\n          return ctx.moduleData.nombre = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(9, \"div\", 3)(10, \"label\", 6);\n        i0.ɵɵtext(11, \"Descripci\\u00F3n:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"textarea\", 7);\n        i0.ɵɵlistener(\"ngModelChange\", function ModuleCrudComponent_Template_textarea_ngModelChange_12_listener($event) {\n          return ctx.moduleData.descripcion = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(13, \"div\", 3)(14, \"label\", 8);\n        i0.ɵɵtext(15, \"URL de la imagen:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"input\", 9);\n        i0.ɵɵlistener(\"ngModelChange\", function ModuleCrudComponent_Template_input_ngModelChange_16_listener($event) {\n          return ctx.moduleData.imagen = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(17, \"div\", 10)(18, \"button\", 11);\n        i0.ɵɵtext(19);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(20, \"div\", 12)(21, \"h2\");\n        i0.ɵɵtext(22, \"Lista de M\\u00F3dulos\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"input\", 13);\n        i0.ɵɵlistener(\"ngModelChange\", function ModuleCrudComponent_Template_input_ngModelChange_23_listener($event) {\n          return ctx.searchTerm = $event;\n        })(\"input\", function ModuleCrudComponent_Template_input_input_23_listener() {\n          return ctx.filterModules();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"ul\");\n        i0.ɵɵtemplate(25, ModuleCrudComponent_li_25_Template, 7, 1, \"li\", 14);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(26, ModuleCrudComponent_div_26_Template, 9, 1, \"div\", 15);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.isEditMode ? \"Editar M\\u00F3dulo\" : \"Crear M\\u00F3dulo\");\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.moduleData.nombre);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.moduleData.descripcion);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.moduleData.imagen);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", !ctx.areFieldsValid());\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.isEditMode ? \"Actualizar\" : \"Crear\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.searchTerm);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.filteredModules);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.moduleToDelete);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm],\n    styles: [\".module-crud-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;padding:20px}.module-form[_ngcontent-%COMP%]{flex:1;background-color:#f8f8f8;border:1px solid #ccc;padding:20px;border-radius:5px;box-shadow:0 0 5px #0003}.module-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:700;margin-bottom:5px}.form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:3px;font-size:1rem}.boton[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:12px 20px;border:none;border-radius:3px;font-size:1rem;text-transform:uppercase;transition:background-color .3s ease}.boton[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.boton[_ngcontent-%COMP%]:hover:not([disabled]){background-color:#0056b3;transform:translateY(-2px)}.module-list[_ngcontent-%COMP%]{flex:1;margin-left:20px}.module-list[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:20px}.module-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.module-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border:1px solid #ccc;padding:10px;margin-bottom:10px;background-color:#fff;border-radius:5px;box-shadow:0 0 5px #0000001a}.module-list[_ngcontent-%COMP%]   .buttons-container[_ngcontent-%COMP%]{display:flex;gap:10px}.module-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#2a9bb7;color:#fff;padding:5px 10px;border:none;border-radius:3px;font-size:.9rem;cursor:pointer}.module-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#280aac}.module-list[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:3px;font-size:1rem;margin-bottom:10px}.module-list[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:focus{border-color:#007bff;box-shadow:0 0 5px #007bff80;outline:none}.error[_ngcontent-%COMP%]{border:2px solid #ff0000}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:999}.modal-content[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:5px;text-align:center;width:50%;box-shadow:0 0 10px #0000004d}.modal-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:20px}.modal-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#1a05a2;color:#fff;padding:10px 20px;border:none;border-radius:3px;font-size:1rem;cursor:pointer;margin-right:10px}.modal-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{background-color:#c31526;margin-top:10px}.modal-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#007bff}.modal-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child:hover{background-color:red}\"]\n  });\n  return ModuleCrudComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}